<Window x:Class="AutoActivator.Gui.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="L.I.S.A Auto-Activator (.NET Version)" Height="650" Width="1000" Background="#F3F3F3">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="220"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Column="0" Background="#2C3E50">
            <TextBlock Text="L.I.S.A" Foreground="White" FontSize="26" Margin="20,30,20,10" FontWeight="Bold" HorizontalAlignment="Center"/>
            <TextBlock Text="Auto-Activator v2.0" Foreground="#BDC3C7" FontSize="12" Margin="0,0,0,30" HorizontalAlignment="Center"/>

            <Button Content="ðŸ“¥ Extraction" Padding="12" Margin="10,5" Click="BtnRun_Click" Background="#34495E" Foreground="White" BorderThickness="0" Cursor="Hand"/>
            <Button Content="âš¡ Activation" Padding="12" Margin="10,5" Click="BtnActivation_Click" Background="#34495E" Foreground="White" BorderThickness="0" Cursor="Hand"/>
            <Button Content="ðŸ“Š Comparison" Padding="12" Margin="10,5" Click="BtnComparison_Click" Background="#34495E" Foreground="White" BorderThickness="0" Cursor="Hand"/>
        </StackPanel>

        <Grid Grid.Column="1" Margin="25">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <StackPanel Grid.Row="0">
                <TextBlock Text="Extraction Module" FontSize="22" FontWeight="Bold" Foreground="#2C3E50" Margin="0,0,0,20"/>

                <Border Background="White" CornerRadius="5" Padding="20" BorderBrush="#DCDDE1" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="Extraction Mode:" Margin="0,0,0,10" FontWeight="Bold" Foreground="#2C3E50"/>

                        <TextBlock Text="1. Single Contract Number (e.g., 182-2728195-31):" Margin="0,0,0,8" FontWeight="SemiBold"/>
                        <TextBox x:Name="TxtContract" Margin="0,0,0,10" Padding="8" FontSize="14" BorderBrush="#DCDDE1"
                                 TextChanged="TxtContract_TextChanged"/>

                        <TextBlock Text="- OR -" HorizontalAlignment="Center" FontWeight="Bold" Foreground="#BDC3C7" Margin="0,5,0,5"/>

                        <TextBlock Text="2. CSV File (Batch extraction):" Margin="0,0,0,8" FontWeight="SemiBold"/>
                        <Grid Margin="0,0,0,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox x:Name="TxtFilePath" IsReadOnly="True" Padding="8" FontSize="14" BorderBrush="#DCDDE1" Grid.Column="0" Margin="0,0,10,0"/>
                            <Button x:Name="BtnBrowse" Content="Browse..." Grid.Column="1" Padding="15,8" Background="#34495E" Foreground="White" BorderThickness="0" Cursor="Hand" Click="BtnBrowse_Click">
                                <Button.Resources>
                                    <Style TargetType="Border">
                                        <Setter Property="CornerRadius" Value="3"/>
                                    </Style>
                                </Button.Resources>
                            </Button>
                        </Grid>

                        <Button x:Name="BtnRun" Content="Run Extraction (LISA &amp; ELIA)" Click="BtnRun_Click"
                                Background="#27AE60" Foreground="White" Padding="12" FontWeight="Bold" BorderThickness="0" Cursor="Hand">
                            <Button.Resources>
                                <Style TargetType="Border">
                                    <Setter Property="CornerRadius" Value="3"/>
                                </Style>
                            </Button.Resources>
                        </Button>

                        <ProgressBar x:Name="PrgLoading" IsIndeterminate="True" Height="10" Margin="0,15,0,0" Visibility="Collapsed"/>
                    </StackPanel>
                </Border>
            </StackPanel>

            <StackPanel Grid.Row="1" Margin="0,20">
                <TextBlock x:Name="TxtStatus" FontSize="14" TextWrapping="Wrap" Foreground="#2F3640"/>

                <TextBlock x:Name="LnkFile" Visibility="Collapsed" Margin="0,10,0,0" FontSize="14">
                    <Hyperlink Click="Hyperlink_Click" Foreground="#2980B9" FontWeight="Bold">
                        <Run Text="ðŸ“ Click here to open extraction results (File or Folder)"/>
                    </Hyperlink>
                </TextBlock>
            </StackPanel>

            <Grid Grid.Row="2" Margin="0,10,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Text="Session History (Sorted by Product)" FontWeight="Bold" Foreground="#7F8C8D" Margin="0,0,0,10"/>

                <ListView x:Name="ListHistory" Grid.Row="1" Background="White" BorderBrush="#DCDDE1" BorderThickness="1" AlternationCount="2">
                    <ListView.ItemContainerStyle>
                        <Style TargetType="ListViewItem">
                            <Setter Property="Padding" Value="5"/>
                            <Style.Triggers>
                                <Trigger Property="ItemsControl.AlternationIndex" Value="1">
                                    <Setter Property="Background" Value="#F9F9F9"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </ListView.ItemContainerStyle>
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Time" DisplayMemberBinding="{Binding Time}" Width="75"/>

                            <GridViewColumn Header="Product" Width="80">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Product}" FontWeight="Bold" Foreground="#8E44AD"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>

                            <GridViewColumn Header="Contract ID" Width="140">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding ContractId}" FontWeight="Bold"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>

                            <GridViewColumn Header="Premium" Width="95">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding Premium}" FontWeight="SemiBold" Foreground="#E67E22"/>
                                            <TextBlock Text=" â‚¬" Foreground="#E67E22"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>

                            <GridViewColumn Header="UCON ID" DisplayMemberBinding="{Binding Ucon}" Width="115"/>

                            <GridViewColumn Header="Demand ID" DisplayMemberBinding="{Binding Hdmd}" Width="115"/>

                            <GridViewColumn Header="Status" Width="95">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="Processed" Foreground="#27AE60" FontStyle="Italic"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                        </GridView>
                    </ListView.View>
                </ListView>
            </Grid>
        </Grid>
    </Grid>
</Window>